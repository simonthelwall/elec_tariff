[
  {
    "objectID": "readme.html",
    "href": "readme.html",
    "title": "",
    "section": "",
    "text": "A repo to analyse my electricity consumption with the Octopus Energy API and OctopusR package. Main content is the optimise.qmd file."
  },
  {
    "objectID": "qmd_docs/optimise.html",
    "href": "qmd_docs/optimise.html",
    "title": "OctopusR for optimising household energy use",
    "section": "",
    "text": "I’ve got solar PV, battery storage, an ASHP and an EV. Finding the right energy tariff to get the most electricity for my use isn’t straightforward. I’m with Octopus Energy, and they have a whole load of different tariffs.\nFortunately, Octopus being the modern sort of a company, they have an API which customers can query and, fortunately, there’s an R package OctopusR which interfaces with that API to make my life easy. I’m going to use that package to look at my electricty usage over the last year and hopefully optimise my tariff choices and battery settings."
  },
  {
    "objectID": "qmd_docs/optimise.html#background",
    "href": "qmd_docs/optimise.html#background",
    "title": "OctopusR for optimising household energy use",
    "section": "",
    "text": "I’ve got solar PV, battery storage, an ASHP and an EV. Finding the right energy tariff to get the most electricity for my use isn’t straightforward. I’m with Octopus Energy, and they have a whole load of different tariffs.\nFortunately, Octopus being the modern sort of a company, they have an API which customers can query and, fortunately, there’s an R package OctopusR which interfaces with that API to make my life easy. I’m going to use that package to look at my electricty usage over the last year and hopefully optimise my tariff choices and battery settings."
  },
  {
    "objectID": "qmd_docs/optimise.html#methods",
    "href": "qmd_docs/optimise.html#methods",
    "title": "OctopusR for optimising household energy use",
    "section": "Methods",
    "text": "Methods\nThe OctopusR package is available on CRAN, the code is on GitHub and there are nice github pages on the package here.\nTo access the API, you need the API key for your account, the MPAN numbers for your meters and the meter serial number. There’s documentation on the API on the Octopus developer pages and Guy Lipman has a nice write-up on his blog.\nIf you have PV, then you have two MPAN numbers, one for import from the grid and one for export. Octopus don’t tell you which is which, but the data make it obvious.\nI’m going to use the get_consumption() function to pull my consumption and export data for the calendar year 2024 into R and do some basic calculations with dplyr. With that data, and some transcribed data about tariff costs for my local area I should be able to find the best tariff for me.\n\n\nCode\nlibrary(octopusR)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(viridis)\nlibrary(lubridate)\n\n# I've got my api key and mpan numbers stored in text files so that they're not exposed here.\nset_api_key(readLines(con = \"../api_key.txt\"))\nset_meter_details(meter_type = \"electricity\",\n                  mpan_mprn = readLines(\"../elec_mtr_mpan.txt\"),\n                  serial_number = readLines(\"../elec_mtr_srl_num.txt\"))\nexp_mpan &lt;- readLines(\"../elec_mtr_mpan_exprt.txt\")\n\n# consumption data\nelec_use &lt;- get_consumption(meter_type = \"elec\", tz = \"GMT\", \n                            period_from = dmy(\"01-01-2024\"),\n                            period_to = dmy(\"31-12-2024\"), \n                            group_by = \"hour\") %&gt;% \n  mutate(mnth = month(interval_start), hr = hour(interval_start))\nhead(elec_use)\n\n\n# A tibble: 6 x 5\n  consumption interval_start      interval_end         mnth    hr\n        &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;int&gt;\n1       1.23  2024-12-31 00:00:00 2024-12-31 01:00:00    12     0\n2       0.237 2024-12-30 23:00:00 2024-12-31 00:00:00    12    23\n3       0.227 2024-12-30 22:00:00 2024-12-30 23:00:00    12    22\n4       0.347 2024-12-30 21:00:00 2024-12-30 22:00:00    12    21\n5       1.50  2024-12-30 20:00:00 2024-12-30 21:00:00    12    20\n6       1.38  2024-12-30 19:00:00 2024-12-30 20:00:00    12    19\n\n\nCode\n# export data\nelec_exp &lt;- get_consumption(meter_type = \"elec\", tz = \"GMT\", \n                             mpan_mprn = exp_mpan, \n                             period_from = dmy(\"01-01-2024\"),\n                             period_to = dmy(\"31-12-2024\"), \n                             group_by = \"hour\") %&gt;% \n  mutate(mnth = month(interval_start), hr = hour(interval_start))\nhead(elec_exp)\n\n\n# A tibble: 6 x 5\n  consumption interval_start      interval_end         mnth    hr\n        &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;dbl&gt; &lt;int&gt;\n1           0 2024-12-31 00:00:00 2024-12-31 01:00:00    12     0\n2           0 2024-12-30 23:00:00 2024-12-31 00:00:00    12    23\n3           0 2024-12-30 22:00:00 2024-12-30 23:00:00    12    22\n4           0 2024-12-30 21:00:00 2024-12-30 22:00:00    12    21\n5           0 2024-12-30 20:00:00 2024-12-30 21:00:00    12    20\n6           0 2024-12-30 19:00:00 2024-12-30 20:00:00    12    19\n\n\nThere is an API endpoint that gives prices for the Agile and Go tariffs, but there isn’t an R function for that yet, so I haven’t used it here. I have checked the Octopus website for the current (late February) prices for my local area (East England).\n\n\nCode\nelec_use &lt;- elec_use %&gt;% \n  mutate(flex_cost = consumption * 0.2557, \n         aira_zero_cost = case_when(\n           # \n           between(hour(interval_start), 16, 19) ~ consumption * 0.4047, \n           between(hour(interval_start), 4, 7)   ~ consumption * 0.1323, \n           between(hour(interval_start), 13, 16)   ~ consumption * 0.1323,\n           between(hour(interval_start), 22, 00) ~ consumption * 0.1323, \n           TRUE ~ consumption * 0.2698 \n         ),\n         flux_cost = case_when(\n           # https://octopus.energy/smart/flux/\n           between(hour(interval_start), 02, 05) ~ consumption * 0.1534, \n           between(hour(interval_start), 16, 19) ~ consumption * 0.2744, \n           TRUE ~ consumption * 0.2557\n         ), \n         go_cost = case_when(\n           # https://octopus.energy/smart/go/\n           between(hour(interval_start), 01, 05) ~ consumption * 0.085, \n           TRUE ~ consumption * 0.271\n         ),\n         intel_go_cost = case_when(\n           # https://octopus.energy/smart/go/\n           between(hour(interval_start), 00, 05) ~ consumption * 0.07, \n           TRUE ~ consumption * 0.271\n         )\n         )"
  },
  {
    "objectID": "qmd_docs/optimise.html#results",
    "href": "qmd_docs/optimise.html#results",
    "title": "OctopusR for optimising household energy use",
    "section": "Results",
    "text": "Results\n\nConsumption costs under different tariffs\nTotal cost (£) per calendar month, 2024\n\n\nCode\nelec_cost &lt;- elec_use %&gt;% \n  group_by(mnth) %&gt;% \n  summarise(across(.cols = c(flex_cost, aira_zero_cost, flux_cost, go_cost, \n                             intel_go_cost), .fns = sum)) %&gt;% \n  mutate(across(.cols = c(flex_cost, aira_zero_cost, flux_cost, go_cost, \n                             intel_go_cost), .fns = round, digits = 2))\nelec_cost\n\n\n# A tibble: 12 x 6\n    mnth flex_cost aira_zero_cost flux_cost go_cost intel_go_cost\n   &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;\n 1     1    302.           282.      284.    275.          262.  \n 2     2    159            144.      150.    144.          135.  \n 3     3    115.            94.6     104.     97.9          90.4 \n 4     4     55.1           39.0      44.4    37.6          33.1 \n 5     5      8.74           8.31      7.86    7.17          6.58\n 6     6      7.17           5.95      6.19    5.48          5.08\n 7     7      3.51           3.66      3.32    3.19          2.83\n 8     8      5.01           5.26      4.64    4.34          3.69\n 9     9     49.0           45.5      44.2    41.1          37.2 \n10    10    128.           117.      117     109.           99.9 \n11    11    260.           260.      249.    241.          231.  \n12    12    278.           269.      269.    266.          256.  \n\n\nSo, for January, I could have saved myself £39.48 if I had been on the Intelligent Go tariff, rather than the Flexible tariff.\nOver the year, these different costs sum to:\n\n\nCode\nelec_cost_yr &lt;- elec_use %&gt;% \n  summarise(across(.cols = c(flex_cost, aira_zero_cost, flux_cost, go_cost, \n                             intel_go_cost), .fns = sum)) %&gt;% \n  mutate(across(.cols = c(flex_cost, aira_zero_cost, flux_cost, go_cost, \n                             intel_go_cost), .fns = round, digits = 2))\nelec_cost_yr\n\n\n# A tibble: 1 x 5\n  flex_cost aira_zero_cost flux_cost go_cost intel_go_cost\n      &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;\n1     1370.          1275.     1283.   1233.         1164.\n\n\nSo, with the Intelligent Go tariff, I could have saved myself £206.5 (15.1%), which is rather less that I had hoped for.\nHowever, I haven’t factored in the daily standing charge, but these are the same for both tariffs at 48.70p / day.\n\n\nSavings by altering my battery plan\nI’ve got a 10 kWh battery system. If I set that to charge on a cheap overnight tariff and then discharge it when that cheap overnight tariff runs out, how much will I save?\nI’m not quite sure how to calculate this, but if, per day, my kWh is &gt; 10, I can shift that 10 kWh to the night time load.\nSo, below I’ve generated an altered consumption column where the load is 10 kWh lower if it’s in the peak period for Intelligent Go and 10 kWh higher in the off-peak period and then used these values to calculate the cost in £.\n\n\nCode\nelec_cost_yr_batt &lt;- elec_use %&gt;% \n  mutate(dt = format(interval_start, \"%Y-%m-%d\"), \n         low_cost_hr = if_else(between(hour(interval_start), 00, 05), 1, 0)) %&gt;%\n  group_by(low_cost_hr, dt) %&gt;%\n  summarise(consumption = sum(consumption)) %&gt;% \n  ungroup() %&gt;% \n  arrange(dt, low_cost_hr) %&gt;% \n  mutate(gt_10_kwh = if_else(low_cost_hr == 0 & consumption &gt;= 10, 1, 0)) %&gt;% \n  group_by(dt) %&gt;% \n  mutate(gt_10_day = max(gt_10_kwh)) %&gt;% \n  ungroup() %&gt;% \n  mutate(consumption_2 = case_when(\n    low_cost_hr == 0 & gt_10_day == 1 ~ consumption - 10, \n    low_cost_hr == 0 & gt_10_day == 0 ~ 0,\n    low_cost_hr == 1                  ~ consumption + 10\n      ), \n    intel_go_cost = if_else(low_cost_hr == 1, \n                            consumption_2 * 0.07, \n                            consumption_2 * 0.271)\n    )\n\n# table(is.na(elec_cost_yr_batt$intel_go_cost))\nhead(elec_cost_yr_batt)\n\n\n# A tibble: 6 x 7\n  low_cost_hr dt     consumption gt_10_kwh gt_10_day consumption_2 intel_go_cost\n        &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;\n1           0 2024-~       19.0          1         1          9.02         2.44 \n2           1 2024-~        3.82         0         1         13.8          0.968\n3           0 2024-~       18.7          1         1          8.68         2.35 \n4           1 2024-~        5.40         0         1         15.4          1.08 \n5           0 2024-~       13.3          1         1          3.27         0.885\n6           1 2024-~        3.71         0         1         13.7          0.960\n\n\nOver the year, this would sum to £920.88 on the Intelligent Go tariff. A further saving of £242.79."
  },
  {
    "objectID": "qmd_docs/optimise.html#discussion",
    "href": "qmd_docs/optimise.html#discussion",
    "title": "OctopusR for optimising household energy use",
    "section": "Discussion",
    "text": "Discussion\nI can save myself £449.29, assuming that my energy use is similar in 2025 to my use in 2024. I did buy an EV in May 2024, so that may alter the total consumption, but it is only likely to tip it further in favour of Intelligent Go since I can schedule the EV charging for the cheap overnight rate. Scheduling consumption to early in the morning has the added advantage of less carbon-intensive too.1\nOne thing that I haven’t modelled here is the effect of charging the batteries at the off-peak rate in the summer. In those periods, I’m probably not going to exhaust the batteries before charging starts (unless the ashp is on a Legionella cycle or a hot-water cycle) and thus a, it won’t take the full 10 kWh from the grid to reach max charge and b, I’ll start exporting to the grid a lot earlier. This is beyond what I want to spend my spare time on but means that the savings presented here are likely to be slightly underestimate the actual savings.\nI love the fact that Octopus Energy have an API where I can check this sort of thing. I also love the fact that someone has been nerdy enough to write an R package to make it easy to interact with the API.\nI think my analyses here are accurate, but if you spot any errors please create an issue on the github repo."
  },
  {
    "objectID": "qmd_docs/optimise.html#footnotes",
    "href": "qmd_docs/optimise.html#footnotes",
    "title": "OctopusR for optimising household energy use",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nhttps://www.wwf.org.uk/challenges/green-energy-time↩︎"
  }
]